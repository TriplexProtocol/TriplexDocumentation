# Synthetix V3 系统架构概述

## 系统架构

Synthetix V3是一个模块化的去中心化金融协议，设计用于管理合成资产的铸造、交易和清算。系统由以下主要组件构成：

### 核心组件

1. **账户系统** - 管理用户账户、权限和身份
2. **抵押品系统** - 处理多种抵押品的存取和价值计算
3. **债务系统** - 管理用户债务、铸造和销毁合成资产
4. **市场系统** - 处理市场注册和与外部市场的交互
5. **流动性池系统** - 管理流动性池和市场连接
6. **清算系统** - 处理不足额抵押头寸的清算
7. **奖励系统** - 管理和分发奖励

### Oracle系统

独立的价格预言机系统，为协议提供各种资产的价格数据。

### 治理系统

管理协议升级和参数调整的去中心化治理机制。

## 模块间关系

```
┌───────────────────────────────────────────────────────────────┐
│                      Synthetix 核心系统                        │
│                                                               │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────────────┐  │
│  │ 账户模块 │  │ 抵押模块 │  │ 发行模块 │  │ 市场管理模块    │  │
│  └─────────┘  └─────────┘  └─────────┘  └─────────────────┘  │
│        │            │            │              │            │
│        └────────────┼────────────┼──────────────┘            │
│                     │            │                           │
│                     ▼            ▼                           │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────────────┐  │
│  │ 池模块   │  │ 清算模块 │  │ USD模块 │  │ 奖励管理模块    │  │
│  └─────────┘  └─────────┘  └─────────┘  └─────────────────┘  │
│                                                               │
└─────────────────────────┬─────────────────────────────────────┘
                          │
                          ▼
              ┌─────────────────────────┐
              │      Oracle 管理器      │
              └─────────────────────────┘
```

## 核心业务流程

1. **铸造合成资产**:
   - 用户存入抵押品
   - 系统计算用户可借贷额度
   - 用户铸造合成美元(snxUSD)

2. **市场交互**:
   - 外部市场向系统注册
   - 市场存取snxUSD进行业务操作

3. **流动性管理**:
   - 创建流动性池
   - 配置池与市场的连接
   - 用户向池提供抵押品

4. **清算流程**:
   - 系统监控头寸健康度
   - 当头寸低于清算阈值时触发清算
   - 清算者获得奖励

## 迁移到Aptos考虑点

1. **资源模型转换**:
   - 将Solidity合约状态转换为Move资源
   - 设计适合资源导向编程模型的数据结构

2. **能力模式设计**:
   - 使用Move的能力系统替代Solidity的访问控制机制
   - 为管理操作设计适当的能力类型

3. **表和事件设计**:
   - 将映射结构转换为Move的Table类型
   - 重新设计事件发送机制

4. **交易脚本与模块设计**:
   - 将Solidity公共函数转换为Move的入口函数和公共函数
   - 设计适合Move的模块结构和依赖关系 